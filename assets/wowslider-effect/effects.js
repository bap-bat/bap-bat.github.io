// cube_over
// options.direction - left,right,down,up
// use: Modernizr library
// based on: http://alexdunphy.github.io/refineslide/demo.html
// shadow algorithm from : http://tympanus.net/Tutorials/3DShadingWithBoxShadows/
// create .ws_effect
// options.fallback 
// options.staticColor - true not use RGBaster
jQuery.extend(jQuery.easing,{easeInOutBack:function(c,g,h,r,a,k){void 0==k&&(k=1.70158);return 1>(g/=a/2)?r/2*g*g*(((k*=1.525)+1)*g-k)+h:r/2*((g-=2)*g*(((k*=1.525)+1)*g+k)+2)+h}});
function ws_cube_over(c,g,h){function r(c,f){f=f||{};var g=f.exclude||[],d,a=document.createElement("canvas"),b=a.getContext("2d");a.width=c.naturalWidth;a.height=c.naturalHeight;b.drawImage(c,0,0,c.naturalWidth,c.naturalHeight);try{d=b.getImageData(f.x?f.x:0,f.y?f.y:0,f.w?f.w:c.width,f.h?f.h:c.height).data}catch(h){return console.log("error:unable to access image data: "+h),"#ccc"}for(var a=(f.w?f.w:c.width*f.h?f.h:c.height)||d.length,b={},e="",k=[],x="",y=0,n=0;n<a;){k[0]=d[n];k[1]=d[n+1];k[2]=
d[n+2];e=k.join(",");b[e]=e in b?b[e]+1:1;if(-1===g.indexOf(["rgb(",e,")"].join(""))){var l=b[e];l>y&&(x=e,y=l)}n+=4}return["rgb(",x,")"].join("")}var a=jQuery,k=a(this),l=/WOW Slider/g.test(navigator.userAgent),z=a(".ws_list",h),A=c.perspective||/MSIE|Trident/g.test(navigator.userAgent)?1E3:2E3,p={position:"absolute",backgroundSize:"cover",left:0,top:0,width:"100%",height:"100%",backfaceVisibility:"hidden"},q=/AppleWebKit/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent),e=a("<div>").css(p).css({transformStyle:"preserve-3d",
perspective:q&&!l?"none":A,zIndex:8});a("<div>").addClass("ws_effect ws_cube_over").css(p).append(e).appendTo(h);if(!c.support.transform&&c.fallback)return new c.fallback(c,g,h);var u;this.go=function(v,f){function B(b,a,d,e){b.parent().css("perspective",A);b.width();b.height();wowAnimate(b,{scale:1,translate:[0,0,q&&!l?d:0]},{scale:.85,translate:[0,0,q&&!l?d:0]},.4*c.duration,"easeInOutBack",function(){wowAnimate(b,{scale:.85,translate:[0,0,q&&!l?d:0]},{scale:1,translate:[0,0,q&&!l?d:0]},.4*c.duration,
c.duration-.8*c.duration,"easeInOutBack",e)});wowAnimate(a.front.item,{rotateY:0,rotateX:0},{rotateY:a.front.rotateY,rotateX:a.front.rotateX},c.duration,"easeInOutBack");wowAnimate(a.back.item,{rotateY:a.back.rotateY,rotateX:a.back.rotateX},{rotateY:0,rotateX:0},c.duration,"easeInOutBack");wowAnimate(a.side.item,{rotateY:a.side.rotateY,rotateX:a.side.rotateX},{rotateY:-a.side.rotateY,rotateX:-a.side.rotateX},c.duration,"easeInOutBack")}var d=a(g[f]),d={width:d.width(),height:d.height(),marginTop:parseFloat(d.css("marginTop")),
marginLeft:parseFloat(d.css("marginLeft"))};if(c.support.transform&&c.support.perspective){u&&u.stop();var m=h.width(),b=h.height(),b={left:[m/2,0,0,180,0,-180],right:[m/2,0,0,-180,0,180],down:[b/2,-b/2,180,0,-180,0],up:[b/2,b/2,-180,0,180,0]}[c.direction||["left","right","down","up"][Math.floor(4*Math.random())]],w=a("<img>").css(d),t=a("<img>").css(d).attr("src",g.get(v).src),m=a("<div>").css({overflow:"hidden",transformOrigin:"50% 50% -"+b[0]+"px"}).css(p).append(w).appendTo(e),d=a("<div>").css({overflow:"hidden",
transformOrigin:"50% 50% -"+b[0]+"px"}).css(p).append(t).appendTo(e),t=a('<div class="ws_cube_side">').css({transformOrigin:"50% 50% -"+b[0]+"px",background:c.staticColor?"":r(t[0],{exclude:["0,0,0","255,255,255"]})}).css(p).appendTo(e);w.on("load",function(){z.hide()});w.attr("src",g.get(f).src).load();e.parent().show();u=new B(e,{front:{item:m,rotateY:b[5],rotateX:b[4]},back:{item:d,rotateY:b[3],rotateX:b[2]},side:{item:t,rotateY:b[3]/2,rotateX:b[2]/2}},-b[0],function(){k.trigger("effectEnd");e.empty().parent().hide();
u=0})}else e.css({position:"absolute",display:"none",zIndex:2,width:"100%",height:"100%"}),e.stop(1,1),b=!!((v-f+1)%g.length)^c.revers?"left":"right",m=a("<div>").css({position:"absolute",left:"0%",right:"auto",top:0,width:"100%",height:"100%"}).css(b,0).append(a(g[f]).clone().css({width:100*d.width/h.width()+"%",height:100*d.height/h.height()+"%",marginLeft:100*d.marginLeft/h.width()+"%"})).appendTo(e),d=a("<div>").css({position:"absolute",left:"100%",right:"auto",top:0,width:"0%",height:"100%"}).append(a(g[v]).clone().css({width:100*
d.width/h.width()+"%",height:100*d.height/h.height()+"%",marginLeft:100*d.marginLeft/h.width()+"%"})).appendTo(e),e.css({left:"auto",right:"auto",top:0}).css(b,0).show(),e.show(),z.hide(),d.animate({width:"100%",left:0},c.duration,"easeInOutExpo",function(){a(this).remove()}),m.animate({width:0},c.duration,"easeInOutExpo",function(){k.trigger("effectEnd");e.empty().hide()})}};
/* easings */
jQuery.extend(jQuery.easing,{easeInOutQuart:function(k,a,h,f,p){return 1>(a/=p/2)?f/2*a*a*a*a+h:-f/2*((a-=2)*a*a*a-2)+h}});
function ws_carousel(k,a,h){function f(b,e){for(var d=0;d<b;d++){for(var c=e?a.length-b+d:d;0>c;)c+=b-a.length;for(;c>a.length-1;)c-=b-a.length;g.push({item:l("<div>").append(l(a[c]).clone().css({outline:"1px solid transparent"})).css({position:"absolute",overflow:"hidden",top:0,left:0,width:"100%",height:"100%"}).appendTo(x),id:c});k.images&&r.push(!k.images[c].noimage)}}function p(){var b=l(a[0]),b={width:b.width(),height:b.height(),marginTop:parseFloat(b.css("marginTop")),marginLeft:parseFloat(b.css("marginLeft"))},
e;for(e in g)g[e]&&g[e].item&&l(g[e].item).find("img").css(b)}function q(b){b*=-1;var e=[],d;for(d in g){var c=2-d;e.push(c!=b?b-c:0)}return e}function t(b,e,d,c){wowAnimate(function(c){u(b,e,c)},0,1,d,c)}function u(b,e,d,c){c||(d=l.easing.easeInOutQuart(1,d,0,1,1,1));for(var a in b){c=b[a];var h=90*(c+(e[a]-c)*d),f=.7,m=0;c=b[a]*(0<b[a]?-1:1);var n=0<h?-1:1;.5<d&&(c=e[a]*(0<e[a]?-1:1));0===b[a]&&(f=(80+-10*d)/100,m=0+(60*n-0)*d);0===e[a]&&(f=(70+10*d)/100,m=60*n,m+=(0-m)*d);0!==e[a]&&0!==b[a]&&(m=
60*n);g[a]&&g[a].item&&(n=g[a].item,k.support.transform?n.css({transform:"scale("+f+") translate3d("+h+"%,0,0) rotateY("+m+"deg)",zIndex:c}):n.css({left:100*(1-f)/2+.85*h+"%",top:100*(1-f)/2+"%",width:100*f+"%"}))}}var l=jQuery,v=l(this),w=l(".ws_list",h).css("opacity",0);/iPhone|iPod|iPad|Android|BlackBerry/.test(navigator.userAgent);var r=[],x=l("<div>").addClass("ws_effect ws_carousel").css({position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",perspective:2E3}).appendTo(h),
g=[];f(2,!0);f(a.length);f(2);h=q(k.startSlide);t(h,h,0);p();l(window).on("load resize",p);this.go=function(b,e){p();w.css("opacity",0);if(k.images&&!r[b+2]){var d=function(a){return a.find("img").attr("src",k.images[b].src)},c=b+2;r[c]=!0;d(g[c].item);2>b&&d(g[g.length-b].item);b+2>=a.length&&d(g[b+2-a.length].item)}window.XMLHttpRequest?(e==a.length-1&&0==b&&(b=e+1),0==e&&b==a.length-1&&(b=-1),t(q(e),q(b),k.duration,function(){v.trigger("effectEnd")})):w.stop(!0).animate({left:b?-b+"00%":/Safari/.test(navigator.userAgent)?
"0%":0},k.duration,"easeInOutExpo",function(){v.trigger("effectEnd")})};this.step=function(b,a){var d=b+(0>a?1:-1);0>a&&(a*=-1);u(q(b),q(d),a,!0)}};
